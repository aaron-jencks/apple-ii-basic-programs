10 REM BARNSLEY FERN
20 HGR
30 X = 0 : Y = 0
40 PRINT "I'LL DRAW A FERN"
50 PRINT "PLEASE ENTER HOW MANY STEPS"
60 INPUT SS

70 FOR S = 0 TO SS

80 REM STEP
90 P = RND(1)
100 IF P <= 0.01 GOTO 1000
110 IF P <= 0.86 GOTO 2000
120 IF P <= 0.93 GOTO 3000
130 GOTO 4000

140 X = A : Y = B
150 HPLOT X * 20 + 140, Y * -15 + 160
160 NEXT
170 END

1000 REM F1
1010 A = 0
1020 B = 0.16 * Y
1030 GOTO 140

2000 REM F2
2010 A = 0.85 * X + 0.04 * Y
2020 B = -0.04 * X + 0.85 * Y + 1.6
2030 GOTO 140

3000 REM F3
3010 A = 0.2 * X - 0.26 * Y
3020 B = 0.23 * X + 0.22 * Y + 1.6
3030 GOTO 140

4000 REM F4
4010 A = -0.15 * X + 0.28 * Y
4020 B = 0.26 * X + 0.24 * Y + 0.44
4030 GOTO 140
